{% extends 'base.html' %}

{% block content %}
<form method="post" class="needs-validation" novalidate>
	<p class="text-center h1 mt-5 mp-2">You Will Join A Channel As <b><i>'{{username}}'</i></b></p>
  <div class="form-floating mb-3 mt-3">
	<input type="text" class="form-control" placeholder="Enter Channel ID" value ="{{channel_id}}" name="channel-ID" required/>
	    <div class="invalid-feedback">Please fill out this field.</div>
	<label for="channel-ID">CHANNEL ID</label>
  </div>
 <div class="input-group mb-3 mt-3">
  <input type="text" class="form-control" placeholder="Enter Password" id="passwordInput" name="passwordInput">
  <button class="btn btn-outline-secondary" type="button" id="togglePassword">SHOW</button>
  </div>
 <button type="submit" class="btn btn-outline-primary d-block mx-auto" name="join">JOIN</button>
</form> 
{% if error is defined %}
	<div style="text-align:center;" id="errorAlert" class="alert alert-danger alert-dismissible fade show mt-3" role="alert">
		<strong>{{error}}</strong>	
		<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
	</div>
{% endif %}

<script>
	// disabling form submissions if there are invalid fields
	(function () {
	  'use strict'

	  // Fetch all the forms we want to apply custom Bootstrap validation styles to
	  var forms = document.querySelectorAll('.needs-validation')

	  // Loop over them and prevent submission
	  Array.prototype.slice.call(forms)
	    .forEach(function (form) {
	      form.addEventListener('submit', function (event) {
		if (!form.checkValidity()) {
		  event.preventDefault()
		  event.stopPropagation()
		}

		form.classList.add('was-validated')
	      }, false)
	    })
	})()


	const togglePassword = document.getElementById("togglePassword");
	const passwordInput = document.getElementById("passwordInput");
	togglePassword.addEventListener("click", togglePass);
	function togglePass(){
		const isPassword = passwordInput.type === "password";
		passwordInput.type = isPassword ? "text" : "password";
		togglePassword.textContent = isPassword ? "HIDE" : "<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free v7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M320 96C239.2 96 174.5 132.8 127.4 176.6C80.6 220.1 49.3 272 34.4 307.7C31.1 315.6 31.1 324.4 34.4 332.3C49.3 368 80.6 420 127.4 463.4C174.5 507.1 239.2 544 320 544C400.8 544 465.5 507.2 512.6 463.4C559.4 419.9 590.7 368 605.6 332.3C608.9 324.4 608.9 315.6 605.6 307.7C590.7 272 559.4 220 512.6 176.6C465.5 132.9 400.8 96 320 96zM176 320C176 240.5 240.5 176 320 176C399.5 176 464 240.5 464 320C464 399.5 399.5 464 320 464C240.5 464 176 399.5 176 320zM320 256C320 291.3 291.3 320 256 320C244.5 320 233.7 317 224.3 311.6C223.3 322.5 224.2 333.7 227.2 344.8C240.9 396 293.6 426.4 344.8 412.7C396 399 426.4 346.3 412.7 295.1C400.5 249.4 357.2 220.3 311.6 224.3C316.9 233.6 320 244.4 320 256z"/></svg>";
	}
	togglePass();

	setTimeout(() => {
		const alert = document.getElementById('errorAlert');
		if(alert){
			const bsAlert = new bootstrap.Alert(alert);
			bsAlert.close();
		}
	}, 2000);
</script>
{% endblock %}
